#include <limits>
#include <iostream>
#include <array>
#include <vector>
#include <cassert>
#include <string>
#include <set>
#include <map>
#include <algorithm>

using namespace std;

class Solution {
public:
    int minimumScore(vector<int>& nums, vector<vector<int>>& edges) {

        int ret = std::numeric_limits<int>::max();


        map<int,set<int>> edge_map;
        for(const auto& from_to: edges){
            edge_map[from_to[0]].insert(from_to[1]);
            edge_map[from_to[1]].insert(from_to[0]);
        }

        for(int i =0 ;i < edges.size()-1; ++i){
            for(int j = i+1;j < edges.size();++j){
                cout<<i<<" "<<j<<"\n";
                auto copy = edge_map;
                copy[edges[i][0]].erase(edges[i][1]);
                copy[edges[i][1]].erase(edges[i][0]);

                copy[edges[j][0]].erase(edges[j][1]);
                copy[edges[j][1]].erase(edges[j][0]);
                int thisRes = score(nums, copy);
                ret = min(ret, thisRes);
            }
        }

        return ret;
        
    }

    int score(const vector<int>& nums, map<int,set<int>>& edge_map){

        int res3[3] =  {0};

        //cout<<"pick0\n";
        res3[0] = recXor(nums,edge_map, edge_map.begin()->first,nums[edge_map.begin()->first]);
        //cout<<"pick1\n";
        res3[1] = recXor(nums,edge_map, edge_map.begin()->first,nums[edge_map.begin()->first]);
        //what left must be set3
        for(const auto& kv: edge_map){
            
            res3[2] = res3[2] xor nums[kv.first];
        }

        sort(res3,res3+3);

        return res3[2]- res3[0];
    }

    int recXor(const vector<int>& nums, map<int,set<int>>& edge_map, int begin, int value){

        assert(edge_map.count(begin));
        auto reach = edge_map.find(begin);

        if(reach == edge_map.end()){
            return value;
        }

        auto subs = reach->second;
        edge_map.erase(reach);

        for(auto sub :subs){
            edge_map[sub].erase(begin);
            value = value xor nums[sub];
        }

        for(auto sub:subs){
            value = recXor(nums,edge_map, sub, value);
        }

        return value;
    }
};

int main(int, char**){
    Solution s;
    {
        vector<int> nums = {1,5,5,4,11};
        vector<vector<int>> edges = {{0,1},{1,2},{1,3},{3,4}};
        assert(s.minimumScore(nums,edges) == 9);
    }
    {
vector<int> nums = {49495257,10432390,28380238,22026346,89045747,61039224,31310639,39079290,11245382,56456574,42855604,53730040,47038698,81339088,58713003,88557844,40642791,20448561,8104501,83807177,13349162,98723832,51355081,97502152,11770733,63916713,84613912,11547820,48224291,45789489,3759818,79478100,16650168,51249542,7499517,61369471,77710826,48946351,51882305,23769409,43952725,77294758,45274121,63919156,45110222,42281881,92578899,71268377,66352371,91630249,64971649,10755078,4333309,21407516,73322374,62475960,7251531,83259246,38039758,50619498,70531851,45224939,83082735,15116638,49896497,40161150,49832201,57103075,2160968,60480880,519439,43567510,93140181,51063773,52241033,81765123,39050361,11041426,57934746,77770615,78501639,8320696,72161702,63899378,61967613,32338661,87957737,88493625,41238722,85215097,77537555,27917959,70050629,91984485,35526616,91099789,85331384,2771396,37613271,73930538,38026956,82801089,14553406,1758055,85166992,13101298,66176278,3931694,22530061,8400081,84143382,9272988,70375015,53320640,42124120,40742440,93084600,99273401,46732552,25298132,71449484,40927736,60970791,75309211,29388674,42886821,73983495,67251051,52921435,23986676,16232436,16637781,18141350,75525942,83513744,1457592,28625351,39163,16796654,6347444,70608738,5950707,63930044,25684996,46763317,4997693,79609559,19291495,12987935,48504130,34606891,14830814,36089018,93319833,34227683,27344777,31727535,21672201,83794136,58381232,89126836,70584120,60870628,9439168,72156082,95564094,26350393,8272138,35397846,50038590,66665468,85908416,88287360,12599312,83693772,64100607,21594927,80574267,27076677,50643320,44222707,74024882,91681074,99545709,90121130,77533365,50735646,90087806,20940122,82078458,14010492,12700415,229830,74811837,74982387,65162332,68801972,8666064,86797714,19790861,10569408,30560342,80734072,21741912,7406323,66999512,33335604,19077536,40467035,61147633,44288297,3649580,27966636,76368082,31389813,56124663,14881822,46135164,95623077,52343316,25572587,58570054,57125670,15273986,69437753,49013175,40932804,40087613,95240116,21096725,33286389,37198043,98259435,39319822,63074969,82978480,63104099,56991411,95466308,57250908,27367853,16860596,18661154,62749603,11221878,46785515,27890337,38575539,94024559,87720356,13343297,83440660,13881604,10672723,43171130,31995984,62227516,66792802,11495736,41448410,96519368,13059633,26018172,46031933,21138304,8267648,23844437,95677609,30163153,45510491,59451266,69861984,15816144,62946399,34206935,74561958,38334176,53114133,7011199,31491480,72073265,26734286,704944,24652758,22071120,47358323,79466555,87039225,83461601,96916931,11207703,12907382,45196826,16019521,34465377,28213644,42455399,70178982,58171654,49434174,72905294,9496389,87495715,57661556,69510785,8068575,84615620,79388211,84628191,68054641,34272791,68559084,76133897,14288467,69180455,16380120,21517846,86380778,28684195,11638874,7106832,95680925,18070314,16158177,88095768,24238001,52466224,14788817,37103658,58285698,44331085,20642337,34702655,40977578,18970390,70937118,38619306,33663333,67508550,91365376,11156662,78180796,56222107,67431070,17770071,85005529,25568912,2489226,70885043,97644659,78723069,35950230,91034744,4141467,51327363,59083246,29899221,61705201,68206996,69586465,91000635,52286424,75771606,42039987,98668597,44957914,93974383,97601041,31807112,58922855,19023769,9899097,51467021,29480733,7287737,32914136,71205015,99917211,79704102,17903484,88353247,28179213,32908944,62085812,36082807,69121490,62663691,53596777,78780579,35139233,93324398,43015129,34808993,7453075,44817907,1893257,29437276,54369488,27410812,17073933,85707061,42662765,40693741,77898850,38605888,7130770,16147348,93242008,123030,47916794,23888829,38937816,97164544,80567184,96367392,31077966,23610439,16119287,68445828,40572630,28630861,30228348,15108275,14574092,35907015,93412102,30191835,21006936,67099362,61465248,8993296,12674028,61857143,73889386,4882044,20195154,12611308,36885666,53845441,96920912,43676376,29377579,62344950,96880656,29774613,4911693,47645731,5043736,65822382,22978254,9239277,27176587,91616055,53644086,65196857,38473541,96657820,80922746,6120172,11168810,64594268,86542806,22011174,13443826,76246494,78869700,10054878,88332064,39679282,227102,4762494,5590619,54639972,67201125,40905103,34966059,44943076,78165342,24702012,40630055,13656896,16660499,36227080,69447558,70134128,65344602,77503600,96272649,61773034,15088620,48654869,67906093,38733669,75874157,68709281,68669898,23245683,49294917,78465366,95453362,64646651,66464010,59049915,52247336,63455361,77082150,80419700,83579974,87918285,79336268,40309917,17425728,54776389,79096538,26893716,14618395,15490729,36540571,2367181,75722517,78500984,3651557,66094954,91690167,28796661,6736957,77263469,60885589,75511337,79028357,38703569,39489723,80626364,58654163,29678402,81856273,37278586,7222696,30352735,65893610,50648826,27542509,5948640,75996091,38720167,19444994,93331209,48429337,88413191,21618384,33743064,29428951,20795729,82933293,43626523,81765761,81568509,35758383,77781653,66351013,66699947,23063254,5721293,45399119,30239600,59632363,17435035,81237064,21672269,7559226,67862715,50914013,58724986,56805139,16052449,37724041,97550364,24104235,91904768,4754076,70552902,88370026,96106356,23656254,99885341,69737636,94304401,90092173,2971227,33352693,31990397,39152982,32086289,63030042,84012706,69725833,77623878,16302169,83740111,91171919,32583522,30495133,58622044,28786914,84559467,31661464,63200905,25940999,69934003,55940309,84437111,97214738,89479864,75807134,53523144,31991692,60280366,40439138,73422299,88108807,15191243,39575105,97682644,68615797,90734709,44471018,10518982,58513525,16367982,48113760,64459620,30454490,75695705,28115776,45241130,15671843,4738101,33927825,82884851,23151352,11934853,62480195,95576592,96206405,35038462,86339666,75687350,4189341,69873720,11043366,22559148,76961041,45214592,13697080,35051986,15833753,76768746,14539746,88035503,9135708,66723498,74429300,75922640,64422275,35459497,81983668,19078070,58358140,46756610,49216003,59913158,7735950,67200574,4165314,6822350,32532382,8520664,74936951,37172881,3246896,86468069,20408206,34018213,47584152,41703078,67150237,42936910,49862314,99271332,1358279,78663387,68718774,47183730,23727417,50326694,33424971,28046876,68080079,82006791,3660519,14235102,39534022,86466945,68701777,60272000,93768003,60546646,67923633,79822028,82887433,65574554,14230915,42101702,66895084,21985497,84042165,71765047,67901457,75137734,40780488,52113896,65086713,41823425,50922243,18889585,39064007,22783474,4154640,85615374,49978645,72296576,45082713,90334359,75221264,30751887,20216447,61320,40868015,18048765,71046809,24930410,8245651,20801258,31445822,37530949,1091709,45848722,75696727,35207408,20629564,45687954,44523448,63705846,27838019,43081857,68637475,15133532,8017375,89484343,96742848,18061620,73603010,557036,85044425,81614429,30856528,62242889,78542460,96526343,96091686,76464197,84165073,17788603,2754495,59950317,88947764,46981549,51431047,29819820,75722302,74212713,288347,96545621,83320897,92623093,36690061,18644852,58684734,72658326,48410971,71906716,46467946,8170936,16382421,1507717,50332766,26919011,14563961,32841032,19474447,40459703,43433536,12236420,29338343,32784982,79193467,73207702,71056731,32779356,99685776,3232008,3276297,51922825,79398597,26327379,87909337,53844600,26976075,82005405,38442335,4741652,4610378,88911020,40939639,15013954,30748492,2593226,37133207,58457787,24916215,8652307,60236980,74815924,9362995,25394441,92415917,15764112,43822082,38937929,97325525,83305468,67786406,35878295,81315673,60055057,20722283,69498547,90621813,49739151,5761122,21098582,68523651,40623482,30441413,4526370,15133629,38293117,2341839,78630000,78272741,37167261,14884057,64059745,98752779,77526320,42150168,25594351,49385964,46015077,55270944,22165298,74634887,1117595,22721439,49516063,89520711,7605213,51433438,83709026,59738340,6979954,86421351,83202423,64829611,69041372,77299742,84528850,1781442,59767917,16022917};


vector<vector<int>> edges ={{578,673},{578,672},{578,180},{672,686},{782,180},{180,199},{199,712},{199,724},{199,281},{382,578},{382,794},{432,724},{92,281},{672,722},{292,673},{432,427},{782,51},{672,551},{824,382},{528,712},{794,510},{620,673},{673,289},{712,732},{471,199},{850,92},{824,491},{728,281},{722,343},{92,598},{794,269},{427,243},{523,824},{510,39},{686,262},{331,471},{527,471},{427,793},{491,249},{794,448},{712,875},{269,129},{202,448},{722,861},{92,135},{482,382},{292,389},{570,269},{89,491},{109,448},{724,227},{471,810},{128,598},{648,824},{600,810},{472,875},{553,732},{471,807},{576,202},{514,471},{827,570},{523,30},{875,676},{346,724},{279,676},{732,832},{262,725},{808,471},{804,712},{129,20},{687,514},{722,17},{78,227},{860,861},{296,527},{129,147},{886,528},{665,472},{34,827},{620,113},{806,180},{206,180},{810,783},{382,337},{456,804},{824,144},{676,674},{674,102},{665,717},{772,620},{139,674},{840,810},{243,373},{447,20},{276,281},{308,794},{556,551},{827,565},{725,185},{102,469},{128,668},{129,727},{626,886},{827,544},{113,649},{578,889},{475,269},{414,382},{674,231},{861,714},{365,448},{147,819},{810,464},{284,289},{365,145},{637,145},{606,296},{174,570},{733,860},{469,134},{703,472},{244,139},{315,674},{878,456},{292,214},{308,285},{621,886},{391,39},{150,850},{626,130},{98,285},{353,144},{145,304},{866,665},{240,491},{139,823},{783,110},{145,33},{17,504},{672,300},{576,592},{861,63},{819,173},{751,866},{292,488},{645,214},{474,343},{92,428},{87,414},{276,36},{886,654},{94,180},{633,39},{362,728},{265,886},{717,189},{443,144},{133,556},{189,259},{779,551},{150,679},{315,27},{443,28},{318,714},{763,556},{309,244},{177,262},{135,76},{292,867},{821,231},{837,262},{648,178},{231,652},{497,110},{586,353},{373,258},{35,27},{776,861},{488,230},{850,351},{285,879},{79,794},{113,378},{414,595},{259,48},{406,528},{818,633},{48,299},{878,750},{51,853},{845,772},{584,343},{285,787},{321,807},{321,803},{580,674},{92,359},{399,382},{464,625},{581,861},{802,240},{591,803},{632,214},{820,804},{788,178},{761,428},{405,147},{141,556},{210,600},{323,725},{141,398},{571,586},{752,810},{194,34},{23,292},{599,794},{875,7},{185,760},{32,626},{33,311},{91,837},{875,295},{73,866},{861,575},{170,860},{866,85},{108,818},{662,108},{337,463},{415,94},{853,711},{414,232},{378,484},{539,337},{688,279},{158,150},{782,636},{551,607},{794,744},{0,365},{782,588},{688,671},{699,578},{571,163},{265,707},{218,456},{310,362},{799,89},{789,98},{816,620},{542,30},{598,384},{342,886},{654,347},{786,373},{89,319},{855,648},{109,395},{100,265},{714,745},{751,457},{756,150},{528,423},{96,133},{179,447},{542,332},{113,277},{406,203},{92,698},{310,801},{147,811},{752,568},{218,101},{396,89},{453,776},{162,707},{444,134},{473,315},{884,347},{508,668},{647,821},{368,686},{314,243},{766,310},{12,728},{711,470},{353,603},{709,591},{785,648},{271,717},{469,74},{783,520},{740,889},{456,37},{575,440},{620,511},{630,884},{528,5},{875,567},{23,379},{265,261},{373,312},{174,124},{836,810},{470,726},{180,24},{137,134},{58,315},{444,476},{501,510},{740,706},{280,395},{165,475},{620,502},{236,141},{48,370},{598,211},{857,527},{408,170},{808,715},{586,266},{837,106},{253,470},{800,343},{569,378},{47,475},{629,189},{137,814},{370,417},{215,85},{319,467},{699,594},{432,708},{405,360},{337,554},{383,823},{385,819},{103,432},{376,861},{358,440},{309,547},{290,5},{695,750},{58,223},{64,586},{455,845},{165,747},{193,262},{20,246},{495,636},{722,303},{145,758},{677,523},{186,875},{734,108},{733,354},{728,723},{405,324},{454,668},{708,29},{752,702},{129,316},{834,463},{788,327},{269,167},{825,520},{852,106},{693,145},{841,109},{266,468},{261,615},{610,652},{288,761},{252,447},{173,622},{841,283},{648,31},{869,570},{759,794},{48,548},{265,604},{324,773},{554,159},{130,493},{810,216},{498,189},{4,5},{603,613},{760,71},{192,565},{207,699},{182,332},{841,577},{82,528},{142,279},{501,111},{575,646},{701,547},{480,30},{374,592},{111,146},{4,411},{391,42},{789,18},{158,507},{601,384},{243,656},{628,37},{758,380},{672,334},{45,411},{660,408},{722,618},{243,56},{51,882},{436,703},{377,804},{265,597},{764,785},{152,128},{354,53},{789,849},{390,717},{508,667},{687,410},{442,380},{208,759},{277,363},{273,337},{167,81},{316,302},{346,880},{528,826},{284,422},{78,412},{147,209},{493,753},{517,359},{546,42},{519,432},{763,485},{530,174},{106,234},{805,603},{59,109},{482,590},{724,505},{607,14},{180,237},{393,457},{736,289},{749,565},{521,33},{793,684},{781,807},{674,838},{517,257},{3,625},{271,364},{873,698},{86,249},{401,665},{10,395},{4,119},{181,711},{29,88},{46,584},{164,825},{536,152},{247,135},{546,868},{502,678},{581,38},{797,474},{202,639},{311,268},{498,212},{180,221},{861,864},{176,728},{759,768},{278,673},{394,544},{657,247},{9,212},{122,417},{643,88},{691,246},{54,889},{815,511},{704,712},{454,371},{479,633},{630,531},{177,439},{839,247},{804,557},{616,31},{310,503},{571,361},{349,5},{868,771},{318,564},{231,441},{334,57},{584,8},{419,861},{141,355},{104,671},{291,71},{770,194},{458,104},{492,821},{260,211},{617,390},{426,814},{317,472},{494,504},{500,207},{867,339},{92,538},{584,197},{690,290},{502,661},{175,503},{66,800},{585,35},{518,271},{67,355},{416,361},{740,320},{6,317},{806,270},{68,480},{681,199},{44,852},{187,861},{50,514},{509,745},{871,212},{154,89},{274,803},{451,20},{350,214},{430,401},{43,665},{601,525},{844,281},{780,577},{737,491},{350,847},{63,242},{635,91},{700,864},{805,65},{496,380},{729,676},{624,91},{99,63},{785,512},{386,626},{451,462},{307,652},{863,737},{530,421},{768,372},{631,772},{392,514},{730,303},{878,833},{178,138},{743,71},{382,655},{657,77},{716,207},{361,644},{64,420},{264,760},{266,697},{610,72},{412,220},{16,7},{639,658},{40,237},{483,42},{496,524},{659,319},{816,229},{15,274},{752,62},{290,294},{642,819},{711,830},{0,345},{121,51},{151,279},{383,605},{868,446},{755,819},{228,448},{208,400},{254,860},{887,613},{5,813},{374,125},{529,661},{452,557},{13,87},{262,366},{105,94},{622,445},{508,669},{282,577},{730,326},{713,332},{574,773},{860,532},{800,798},{560,454},{335,565},{699,116},{846,105},{0,161},{440,155},{772,682},{620,226},{612,216},{649,251},{17,721},{650,766},{773,566},{670,820},{273,313},{570,883},{760,757},{117,320},{516,783},{421,367},{80,412},{549,850},{562,334},{425,630},{653,584},{325,181},{774,36},{459,733},{233,889},{533,658},{377,582},{543,860},{25,17},{567,490},{299,558},{489,44},{191,483},{405,424},{676,627},{293,889},{513,855},{196,408},{163,828},{762,6},{447,537},{616,460},{778,834},{381,285},{741,151},{482,477},{680,691},{872,816},{323,619},{115,155},{522,801},{123,676},{124,402},{506,327},{33,550},{742,732},{404,516},{36,541},{326,552},{90,580},{49,82},{373,874},{93,308},{727,131},{638,151},{587,653},{591,387},{435,470},{417,765},{241,823},{186,602},{499,59},{169,581},{501,862},{230,748},{876,819},{226,356},{286,814},{527,407},{441,118},{120,152},{235,519},{763,195},{141,651},{830,143},{633,84},{579,472},{535,345},{556,738},{329,556},{220,172},{573,194},{265,263},{264,767},{675,716},{718,327},{441,26},{877,565},{374,1},{888,543},{238,646},{209,126},{330,286},{505,397},{217,254},{341,377},{140,355},{21,584},{201,14},{463,466},{232,754},{245,285},{89,222},{297,289},{566,250},{557,809},{525,225},{200,707},{307,336},{450,584},{724,55},{107,32},{413,169},{698,344},{840,870},{307,746},{127,8},{596,811},{396,166},{649,301},{125,705},{301,790},{775,797},{70,807},{858,707},{112,801},{476,885},{434,670},{664,309},{298,260},{608,447},{339,791},{651,534},{776,720},{515,721},{375,130},{562,97},{163,449},{2,243},{90,184},{340,512},{22,840},{403,299},{59,614},{236,437},{593,650},{156,243},{828,623},{223,160},{420,114},{583,298},{173,409},{534,429},{774,352},{851,335},{744,856},{719,851},{831,674},{299,796},{290,526},{886,812},{563,780},{459,438},{478,811},{239,850},{487,582},{833,205},{476,183},{640,695},{539,685},{95,807},{850,611},{257,136},{198,814},{847,433},{168,107},{333,90},{399,689},{176,696},{777,638},{822,423},{157,677},{256,828},{133,322},{485,634},{696,204},{305,603},{666,50},{291,52},{287,243},{69,750},{773,881},{111,248},{178,188},{541,865},{272,263},{83,279},{785,843},{175,132},{859,665},{102,835},{219,667},{732,461},{18,589},{641,26},{716,60},{878,710},{11,537},{190,428},{842,80},{174,795},{421,663},{148,291},{264,829},{138,171},{792,197},{545,264},{5,694},{473,817},{692,407},{784,880},{317,357},{724,769},{275,161},{870,348},{731,58},{663,854},{486,359},{41,398},{550,465},{554,267},{186,418},{418,369},{729,735},{852,61},{149,587},{559,378},{518,153},{282,328},{794,224},{66,75},{431,340},{561,619},{572,273},{306,470},{502,609},{678,739},{555,20},{338,574},{83,255},{471,848},{19,519},{388,173},{683,886},{481,772},{213,39},{284,540}};
        s.minimumScore(nums,edges) ;
    }
    //too slow
}
